(this["webpackJsonprest-client-tasks"]=this["webpackJsonprest-client-tasks"]||[]).push([[0],{134:function(e,t,a){},258:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(30),c=a.n(n),i=a(27),l=(a(134),a(6)),o=a(7),u=a(263),d=a(261),j=a(127),b=a(268),m=a(20),h=a(11),p=a.n(h),O=a(31),x=a.n(O),v="https://rest-todoapp.herokuapp.com/api",f=function(){var e=Object(m.a)(p.a.mark((function e(t,a,s){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(v+"/signup",{method:"POST",body:JSON.stringify({email:t,password:s,username:a}),headers:{"Content-Type":"application/json"}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,a,s){return e.apply(this,arguments)}}(),g=function(){var e=Object(m.a)(p.a.mark((function e(t,a){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(v+"/login",{method:"POST",body:JSON.stringify({email:t,password:a}),headers:{"Content-Type":"application/json"}});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),k=function(){var e=Object(m.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("user")),localStorage.removeItem("user"),e.next=4,fetch(v+"/logout",{method:"POST",body:JSON.stringify({refreshToken:t.refreshToken})});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(m.a)(p.a.mark((function e(t){var a,s,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(localStorage.getItem("user")),e.prev=1,e.next=4,x.a.post(v+"/refresh",{refreshToken:a.refreshToken});case 4:return s=e.sent,r=s.data,console.log("Got new access token and refresh token"),localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify(r)),t.response.config.headers.Authorization="Bearer "+r.accessToken,e.abrupt("return",Promise.resolve());case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),y={signup:f,login:g,logout:k,getCurrentUser:function(){return JSON.parse(localStorage.getItem("user"))},refreshAuthLogic:N},w=a(266),S=a(260),C=a(47),T=a(25),I=a(46),B=a(1),E=function(e){var t=e.setUsername,a=e.setIsAuth,r=Object(s.useState)([]),n=Object(l.a)(r,2),c=n[0],o=n[1],u=T.a().shape({password:T.b().required("*Password is required"),email:T.b().email("*Must be a valid email address").max(100,"*Email must be less than 100 characters").required("*Email is required")}),d=function(){var e=Object(m.a)(p.a.mark((function e(s){var r,n,c,i,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.email,n=s.password,e.next=3,y.login(r,n);case 3:return c=e.sent,e.next=6,c.text();case 6:i=e.sent,l=JSON.parse(i),t("43!"),c.ok?(a(!0),localStorage.setItem("user",JSON.stringify(l)),u=Object(I.a)(l.accessToken),t(u.name)):o(l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{className:"p-3 mt-4",children:[Object(B.jsx)(C.a,{initialValues:{email:"",password:""},validationSchema:u,onSubmit:d,children:function(e){var t=e.values,a=e.errors,s=e.touched,r=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(B.jsxs)(w.a,{onSubmit:c,children:[Object(B.jsx)("h1",{className:"text-center",children:" Login "}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(B.jsx)(w.a.Label,{children:"Email address"}),Object(B.jsx)(w.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:r,onBlur:n,value:t.email,className:s.email&&a.email?"error":null}),s.email&&a.email?Object(B.jsx)("div",{className:"error-message",children:a.email}):null]}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(B.jsx)(w.a.Label,{children:"Password"}),Object(B.jsx)(w.a.Control,{name:"password",type:"password",onChange:r,onBlur:n,placeholder:"Password",value:t.password,className:s.password&&a.password?"error":null}),s.password&&a.password?Object(B.jsx)("div",{className:"error-message",children:a.password}):null]}),"Don't have an account? ",Object(B.jsx)(i.b,{to:"/signup",children:"Sign up"}),"! ",Object(B.jsx)("div",{}),Object(B.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-4",children:"Log In"})]})}}),c.general&&Object(B.jsx)("p",{className:"text-danger text-end",children:c.general})]})},L=function(e){var t=e.setIsAuth,a=e.setUsername,r=Object(s.useState)([]),n=Object(l.a)(r,2),c=n[0],o=n[1],u=T.a().shape({password:T.b().required("*Password is required"),email:T.b().email("*Must be a valid email address").max(100,"*Email must be less than 100 characters").required("*Email is required"),username:T.b().max(15,"*Username must be less than 15 characters").required("*Username is required")}),d=function(){var e=Object(m.a)(p.a.mark((function e(s){var r,n,c,i,l,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.email,n=s.password,c=s.username,e.next=3,y.signup(r,c,n);case 3:return i=e.sent,e.next=6,i.text();case 6:l=e.sent,u=JSON.parse(l),i.ok?(t(!0),localStorage.setItem("user",JSON.stringify(u)),d=Object(I.a)(u.accessToken),a(d.name)):o(u);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(B.jsxs)("div",{className:"p-3 mt-4",children:[Object(B.jsx)(C.a,{initialValues:{email:"",password:"",username:""},validationSchema:u,onSubmit:d,children:function(e){var t=e.values,a=e.errors,s=e.touched,r=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(B.jsxs)(w.a,{onSubmit:c,children:[Object(B.jsx)("h1",{className:"text-center",children:" Signup "}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(B.jsx)(w.a.Label,{children:"Email address"}),Object(B.jsx)(w.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:r,onBlur:n,value:t.email,className:s.email&&a.email?"error":null}),s.email&&a.email?Object(B.jsx)("div",{className:"error-message",children:a.email}):null]}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicUsername",children:[Object(B.jsx)(w.a.Label,{children:"Username"}),Object(B.jsx)(w.a.Control,{name:"username",type:"text",placeholder:"Enter your username",onChange:r,onBlur:n,value:t.username,className:s.username&&a.username?"error":null}),s.username&&a.username?Object(B.jsx)("div",{className:"error-message",children:a.username}):null]}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(B.jsx)(w.a.Label,{children:"Password"}),Object(B.jsx)(w.a.Control,{name:"password",type:"password",onChange:r,onBlur:n,placeholder:"Password",value:t.password,className:s.password&&a.password?"error":null}),s.password&&a.password?Object(B.jsx)("div",{className:"error-message",children:a.password}):null]}),"Already have an acount? ",Object(B.jsx)(i.b,{to:"/login",children:"Log in!"}),"! ",Object(B.jsx)("div",{}),Object(B.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-3",children:"Sign Up"})]})}}),c.email&&Object(B.jsx)("p",{className:"text-danger text-end",children:c.email})]})},A=function(e){var t=e.addTask,a=e.errors,s=T.a().shape({title:T.b().max(100,"*Title must be less than 100 characters").required("*Title is required"),body:T.b().max(250,"*Email must be less than 100 characters").required("*Description is required")});return Object(B.jsx)("div",{children:Object(B.jsxs)("div",{className:"p-3 mt-4",children:[Object(B.jsx)(C.a,{initialValues:{title:"",body:""},validationSchema:s,onSubmit:function(e){var a=e.body,s=e.title;t({title:s,body:a,completed:!1})},children:function(e){var t=e.values,a=e.errors,s=e.touched,r=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(B.jsxs)(w.a,{onSubmit:c,children:[Object(B.jsx)("h3",{className:"text-center",children:"Tasks"}),Object(B.jsxs)(w.a.Group,{className:"mb-3",children:[Object(B.jsx)(w.a.Label,{children:"Task title"}),Object(B.jsx)(w.a.Control,{name:"title",type:"text",placeholder:"Enter title",onChange:r,onBlur:n,value:t.title,className:s.title&&a.title?"error":null}),s.title&&a.title?Object(B.jsx)("div",{className:"error-message",children:a.title}):null]}),Object(B.jsxs)(w.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(B.jsx)(w.a.Label,{children:"Task description"}),Object(B.jsx)(w.a.Control,{as:"textarea",name:"body",type:"text",onChange:r,onBlur:n,placeholder:"Enter description",value:t.body,className:s.body&&a.body?"error":null}),s.body&&a.body?Object(B.jsx)("div",{className:"error-message",children:a.body}):null]}),Object(B.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-2 mb-4",children:"Add Task"})]})}}),a.general&&Object(B.jsx)("p",{className:"text-danger text-end",children:a.general})]})})},q=a(262),J=a(265),U=function(e){var t=e.id,a=e.title,r=e.description,n=e.completed,c=e.changeTaskState,i=e.editTask,o=e.deleteTask,u=Object(s.useState)(!1),b=Object(l.a)(u,2),m=b[0],h=b[1],p=Object(s.useState)(a),O=Object(l.a)(p,2),x=O[0],v=O[1],f=Object(s.useState)(r),g=Object(l.a)(f,2),k=g[0],N=g[1],y=function(){h(!1),v(a),N(r)};return Object(B.jsx)("div",{children:Object(B.jsxs)(j.a,{className:"justify-content-center ps-5 pb-3",children:[Object(B.jsxs)(d.a,{className:"border-bottom",children:[Object(B.jsxs)(j.a,{children:[Object(B.jsx)("h5",{children:a}),Object(B.jsx)("p",{children:r}),Object(B.jsx)("p",{children:n?Object(B.jsx)(q.a,{bg:"success",className:"my-2",children:"Completed!"}):""})]}),Object(B.jsxs)(j.a,{md:2,className:"p-2",children:[Object(B.jsx)(w.a,{children:Object(B.jsx)(S.a,{variant:"info",size:"sm",className:"my-1 btn-block",onClick:function(){v(a),N(r),h(!0)},children:"Edit"})}),n?Object(B.jsx)(w.a,{children:Object(B.jsx)(S.a,{variant:"secondary",size:"sm",className:"my-1 btn-block",onClick:function(){return c(t)},children:"Undo"})}):Object(B.jsx)(w.a,{children:Object(B.jsx)(S.a,{variant:"success",size:"sm",className:"my-1 btn-block",onClick:function(){return c(t)},children:"Complete"})}),Object(B.jsx)(w.a,{children:Object(B.jsx)(S.a,{variant:"danger",size:"sm",className:"my-1 btn-block",onClick:function(){return o(t)},children:"Delete"})})]})]}),Object(B.jsxs)(J.a,{show:m,onHide:y,children:[Object(B.jsx)(J.a.Header,{closeButton:!0,children:Object(B.jsx)(J.a.Title,{children:"Edit Task"})}),Object(B.jsx)(J.a.Body,{children:Object(B.jsxs)(w.a,{children:[Object(B.jsxs)(w.a.Group,{controlId:"title",children:[Object(B.jsx)(w.a.Label,{children:"Title"}),Object(B.jsx)(w.a.Control,{type:"text",value:x,onChange:function(e){return v(e.target.value)}})]}),Object(B.jsxs)(w.a.Group,{controlId:"description",children:[Object(B.jsx)(w.a.Label,{children:"Description"}),Object(B.jsx)(w.a.Control,{type:"text",value:k,onChange:function(e){return N(e.target.value)}})]})]})}),Object(B.jsxs)(J.a.Footer,{children:[Object(B.jsx)(S.a,{variant:"secondary",onClick:y,children:"Close"}),Object(B.jsx)(S.a,{variant:"primary",onClick:function(){return function(e,a){y(),""!==e&&""!==a&&(i({id:t,title:e,body:a}),v(e),N(a))}(x,k)},children:"Save Changes"})]})]})]})})},P=a(264);function G(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{headers:{Authorization:"Bearer "+e.accessToken}}:{}}var z=a(267),D=a(128),M=a.n(D),V=function(){var e=Object(s.useState)([]),t=Object(l.a)(e,2),a=t[0],r=t[1],n=Object(s.useState)([]),c=Object(l.a)(n,2),i=c[0],o=c[1],b=Object(s.useState)(!1),h=Object(l.a)(b,2),O=h[0],f=h[1],g=Object(s.useState)(!1),k=Object(l.a)(g,2),N=k[0],w=k[1],S=Object(s.useState)(!1),C=Object(l.a)(S,2),T=C[0],I=C[1],E=Object(s.useState)(!0),L=Object(l.a)(E,2),q=L[0],J=L[1];M()(x.a,y.refreshAuthLogic),Object(s.useEffect)((function(){y.getCurrentUser()&&D()}),[]);var D=function(){var e=Object(m.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.get(v+"/tasks",G());case 3:t=e.sent,a=t.data,r(a),J(!1),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.post(v+"/tasks",t,G());case 3:D(),K(),f(!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(m.a)(p.a.mark((function e(t){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=a.find((function(e){return e.id===t}))).completed=!s.completed,e.prev=2,e.next=5,x.a.patch(v+"/tasks/".concat(t),s,G());case 5:D(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.patch(v+"/tasks/".concat(t.id),t,G());case 3:K(),I(!0),D(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(m.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.delete(v+"/tasks/".concat(t),G());case 3:K(),w(!0),D(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){f(!1),w(!1),I(!1)};return Object(B.jsx)("div",{className:"wrapper",children:y.getCurrentUser&&Object(B.jsx)(u.a,{children:Object(B.jsxs)(d.a,{className:"justify-content-center",children:[Object(B.jsxs)("div",{className:"mt-2",children:[Object(B.jsx)(z.a,{onClose:function(){return f(!1)},dismissible:!0,show:O,variant:"success",children:"Task was added"}),Object(B.jsx)(z.a,{onClose:function(){return w(!1)},dismissible:!0,show:N,variant:"danger",children:"Task was deleted"}),Object(B.jsx)(z.a,{onClose:function(){return I(!1)},dismissible:!0,show:T,variant:"warning",children:"Task was edited"})]}),Object(B.jsxs)(j.a,{children:[Object(B.jsx)(A,{addTask:V,errors:i,setErrors:o}),q?Object(B.jsx)("div",{style:{padding:"15px",display:"flex",justifyContent:"center"},children:Object(B.jsx)(P.a,{animation:"border",variant:"info",role:"status",children:Object(B.jsx)("span",{className:"visually-hidden text-center p-3",children:"Loading..."})})}):a.map((function(e,t){return Object(B.jsx)(U,{errors:i,setErrors:o,id:e.id,title:e.title,completed:e.completed,description:e.body,changeTaskState:H,editTask:F,deleteTask:W},t)}))]})]})})})};a(257);var H=function(){var e=Object(s.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],n=Object(s.useState)(""),c=Object(l.a)(n,2),m=c[0],h=c[1];Object(s.useEffect)((function(){var e=y.getCurrentUser();if(e){r(!0);var t=Object(I.a)(e.accessToken);h(t.name)}}),[]);var p=function(e){var t=e.auth.isAuthenticated,a=e.children;return t?a:Object(B.jsx)(o.a,{to:"/login"})},O=function(e){var t=e.auth.isAuthenticated,a=e.children;return t?a:Object(B.jsx)(o.a,{to:"/home"})};return Object(B.jsxs)("div",{children:[Object(B.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:Object(B.jsxs)("div",{className:"container",children:[Object(B.jsx)("div",{className:"navbar-nav mr-auto",children:Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(i.b,{to:"/",className:"nav-link",children:"MyTasks"})})}),a?Object(B.jsxs)("div",{className:"navbar-nav ms-auto",children:[Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsxs)("span",{className:"nav-link",children:["Welcome ",Object(B.jsxs)("strong",{children:[m," "]})]})}),Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(i.b,{to:"/login",className:"nav-link",onClick:function(){y.logout(),window.location.reload()},children:"Logout"})})]}):Object(B.jsxs)("div",{className:"navbar-nav ms-auto",children:[Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(i.b,{to:"/login",className:"nav-link",children:"Login"})}),Object(B.jsx)("li",{className:"nav-item",children:Object(B.jsx)(i.b,{to:"/signup",className:"nav-link",children:"Sign up"})})]})]})}),Object(B.jsx)("div",{className:"container",children:Object(B.jsx)(u.a,{children:Object(B.jsx)(d.a,{className:"justify-content-center pt-5",children:Object(B.jsx)(j.a,{md:"8",children:Object(B.jsx)(b.a,{children:Object(B.jsxs)(o.d,{children:[Object(B.jsx)(o.b,{path:"/",element:Object(B.jsxs)(p,{auth:{isAuthenticated:a},children:[" ",Object(B.jsx)(V,{})," "]})}),Object(B.jsx)(o.b,{path:"/home",element:Object(B.jsxs)(p,{auth:{isAuthenticated:a},children:[" ",Object(B.jsx)(V,{})," "]})}),Object(B.jsx)(o.b,{path:"/signup",element:Object(B.jsxs)(O,{auth:{isAuthenticated:!a},children:[" ",Object(B.jsx)(L,{setIsAuth:r,username:m,setUsername:h})," "]})}),Object(B.jsx)(o.b,{path:"/login",element:Object(B.jsxs)(O,{auth:{isAuthenticated:!a},children:[" ",Object(B.jsx)(E,{username:m,setUsername:h,setIsAuth:r})," "]})})]})})})})})})]})};c.a.render(Object(B.jsx)(r.a.StrictMode,{children:Object(B.jsx)(i.a,{children:Object(B.jsx)(H,{})})}),document.getElementById("root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.aa709195.chunk.js.map