(this["webpackJsonprest-client"]=this["webpackJsonprest-client"]||[]).push([[0],{133:function(e,t,a){},257:function(e,t,a){"use strict";a.r(t);var r=a(0),s=a.n(r),n=a(30),c=a.n(n),i=a(24),l=(a(133),a(6)),o=a(7),u=a(262),d=a(260),j=a(126),b=a(266),h=a(20),m=a(11),p=a.n(m),O=a(31),x=a.n(O),v="http://api.test/api",f=function(){var e=Object(h.a)(p.a.mark((function e(t,a,r){var s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(v+"/signup",{method:"POST",body:JSON.stringify({email:t,password:r,username:a}),headers:{"Content-Type":"application/json"}});case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),g=function(){var e=Object(h.a)(p.a.mark((function e(t,a){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(v+"/login",{method:"POST",body:JSON.stringify({email:t,password:a}),headers:{"Content-Type":"application/json"}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),w=function(){var e=Object(h.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("user")),localStorage.removeItem("user"),e.next=4,fetch(v+"/logout",{method:"POST",body:JSON.stringify({refreshToken:t.refreshToken})});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(h.a)(p.a.mark((function e(t){var a,r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=JSON.parse(localStorage.getItem("user")),e.prev=1,e.next=4,x.a.post(v+"/refresh",{refreshToken:a.refreshToken});case 4:return r=e.sent,s=r.data,console.log("Got new access token and refresh token"),localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify(s)),t.response.config.headers.Authorization="Bearer "+s.accessToken,e.abrupt("return",Promise.resolve());case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),k={signup:f,login:g,logout:w,getCurrentUser:function(){return JSON.parse(localStorage.getItem("user"))},refreshAuthLogic:N},y=a(264),S=a(259),C=a(46),T=a(26),I=a(1),B=function(e){e.setLoginShow;var t=Object(r.useState)([]),a=Object(l.a)(t,2),s=a[0],n=a[1],c=Object(o.g)(),u=T.a().shape({password:T.b().required("*Password is required"),email:T.b().email("*Must be a valid email address").max(100,"*Email must be less than 100 characters").required("*Email is required")}),d=function(){var e=Object(h.a)(p.a.mark((function e(t){var a,r,s,i,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,r=t.password,e.next=3,k.login(a,r);case 3:return s=e.sent,e.next=6,s.text();case 6:i=e.sent,l=JSON.parse(i),s.ok?(localStorage.setItem("user",JSON.stringify(l)),c("/"),window.location.reload()):n(l);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{className:"p-3 mt-4",children:[Object(I.jsx)(C.a,{initialValues:{email:"",password:""},validationSchema:u,onSubmit:d,children:function(e){var t=e.values,a=e.errors,r=e.touched,s=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(I.jsxs)(y.a,{onSubmit:c,children:[Object(I.jsx)("h1",{className:"text-center",children:" Login "}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(I.jsx)(y.a.Label,{children:"Email address"}),Object(I.jsx)(y.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:s,onBlur:n,value:t.email,className:r.email&&a.email?"error":null}),r.email&&a.email?Object(I.jsx)("div",{className:"error-message",children:a.email}):null]}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(I.jsx)(y.a.Label,{children:"Password"}),Object(I.jsx)(y.a.Control,{name:"password",type:"password",onChange:s,onBlur:n,placeholder:"Password",value:t.password,className:r.password&&a.password?"error":null}),r.password&&a.password?Object(I.jsx)("div",{className:"error-message",children:a.password}):null]}),"Don't have an account? ",Object(I.jsx)(i.b,{to:"/signup",children:"Sign up"}),"! ",Object(I.jsx)("div",{}),Object(I.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-4",children:"Log In"})]})}}),s.general&&Object(I.jsx)("p",{className:"text-danger text-end",children:s.general})]})},E=function(e){var t=e.setIsAUth,a=Object(r.useState)([]),s=Object(l.a)(a,2),n=s[0],c=s[1],u=Object(o.g)(),d=T.a().shape({password:T.b().required("*Password is required"),email:T.b().email("*Must be a valid email address").max(100,"*Email must be less than 100 characters").required("*Email is required"),username:T.b().max(15,"*Username must be less than 15 characters").required("*Username is required")}),j=function(){var e=Object(h.a)(p.a.mark((function e(a){var r,s,n,i,l,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.email,s=a.password,n=a.username,e.next=3,k.signup(r,n,s);case 3:return i=e.sent,e.next=6,i.text();case 6:l=e.sent,o=JSON.parse(l),201!==i.status?c(o):(t(!0),localStorage.setItem("user",JSON.stringify(o)),u("/home"),window.location.reload());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{className:"p-3 mt-4",children:[Object(I.jsx)(C.a,{initialValues:{email:"",password:"",username:""},validationSchema:d,onSubmit:j,children:function(e){var t=e.values,a=e.errors,r=e.touched,s=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(I.jsxs)(y.a,{onSubmit:c,children:[Object(I.jsx)("h1",{className:"text-center",children:" Signup "}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(I.jsx)(y.a.Label,{children:"Email address"}),Object(I.jsx)(y.a.Control,{name:"email",type:"email",placeholder:"Enter email",onChange:s,onBlur:n,value:t.email,className:r.email&&a.email?"error":null}),r.email&&a.email?Object(I.jsx)("div",{className:"error-message",children:a.email}):null]}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicUsername",children:[Object(I.jsx)(y.a.Label,{children:"Username"}),Object(I.jsx)(y.a.Control,{name:"username",type:"text",placeholder:"Enter your username",onChange:s,onBlur:n,value:t.username,className:r.username&&a.username?"error":null}),r.username&&a.username?Object(I.jsx)("div",{className:"error-message",children:a.username}):null]}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(I.jsx)(y.a.Label,{children:"Password"}),Object(I.jsx)(y.a.Control,{name:"password",type:"password",onChange:s,onBlur:n,placeholder:"Password",value:t.password,className:r.password&&a.password?"error":null}),r.password&&a.password?Object(I.jsx)("div",{className:"error-message",children:a.password}):null]}),"Already have an acount? ",Object(I.jsx)(i.b,{to:"/login",children:"Log in!"}),"! ",Object(I.jsx)("div",{}),Object(I.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-3",children:"Sign Up"})]})}}),n.email&&Object(I.jsx)("p",{className:"text-danger text-end",children:n.email})]})},L=function(e){var t=e.addTask,a=e.errors,r=T.a().shape({title:T.b().max(100,"*Title must be less than 100 characters").required("*Title is required"),body:T.b().max(250,"*Email must be less than 100 characters").required("*Description is required")});return Object(I.jsx)("div",{children:Object(I.jsxs)("div",{className:"p-3 mt-4",children:[Object(I.jsx)(C.a,{initialValues:{title:"",body:""},validationSchema:r,onSubmit:function(e){var a=e.body,r=e.title;t({title:r,body:a,completed:!1})},children:function(e){var t=e.values,a=e.errors,r=e.touched,s=e.handleChange,n=e.handleBlur,c=e.handleSubmit;return Object(I.jsxs)(y.a,{onSubmit:c,children:[Object(I.jsx)("h3",{className:"text-center",children:"Tasks"}),Object(I.jsxs)(y.a.Group,{className:"mb-2",children:[Object(I.jsx)(y.a.Label,{children:"Task title"}),Object(I.jsx)(y.a.Control,{name:"title",type:"text",placeholder:"Enter title",onChange:s,onBlur:n,value:t.title,className:r.title&&a.title?"error":null}),r.title&&a.title?Object(I.jsx)("div",{className:"error-message",children:a.title}):null]}),Object(I.jsxs)(y.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(I.jsx)(y.a.Label,{children:"Task description"}),Object(I.jsx)(y.a.Control,{as:"textarea",name:"body",type:"text",onChange:s,onBlur:n,placeholder:"Enter description",value:t.body,className:r.body&&a.body?"error":null}),r.body&&a.body?Object(I.jsx)("div",{className:"error-message",children:a.body}):null]}),Object(I.jsx)(S.a,{variant:"primary",type:"submit",className:"mt-2 mb-4",children:"Add Task"})]})}}),a.general&&Object(I.jsx)("p",{className:"text-danger text-end",children:a.general})]})})},A=a(261),q=a(263),J=function(e){var t=e.id,a=e.title,s=e.description,n=e.completed,c=e.changeTaskState,i=e.editTask,o=e.deleteTask,u=Object(r.useState)(!1),b=Object(l.a)(u,2),h=b[0],m=b[1],p=Object(r.useState)(a),O=Object(l.a)(p,2),x=O[0],v=O[1],f=Object(r.useState)(s),g=Object(l.a)(f,2),w=g[0],N=g[1],k=function(){m(!1),v(a),N(s)};return Object(I.jsx)("div",{children:Object(I.jsxs)(j.a,{className:"justify-content-center ps-5 pb-3",children:[Object(I.jsxs)(d.a,{className:"border-bottom",children:[Object(I.jsxs)(j.a,{children:[Object(I.jsx)("h5",{children:a}),Object(I.jsx)("p",{children:s}),Object(I.jsx)("p",{children:n?Object(I.jsx)(A.a,{bg:"success",className:"my-2",children:"Completed!"}):""})]}),Object(I.jsxs)(j.a,{md:2,className:"p-2",children:[Object(I.jsx)(y.a,{children:Object(I.jsx)(S.a,{variant:"info",size:"sm",className:"my-1 btn-block",onClick:function(){return m(!0)},children:"Edit"})}),n?Object(I.jsx)(y.a,{children:Object(I.jsx)(S.a,{variant:"secondary",size:"sm",className:"my-1 btn-block",onClick:function(){return c(t)},children:"Undo"})}):Object(I.jsx)(y.a,{children:Object(I.jsx)(S.a,{variant:"success",size:"sm",className:"my-1 btn-block",onClick:function(){return c(t)},children:"Complete"})}),Object(I.jsx)(y.a,{children:Object(I.jsx)(S.a,{variant:"danger",size:"sm",className:"my-1 btn-block",onClick:function(){return o(t)},children:"Delete"})})]})]}),Object(I.jsxs)(q.a,{show:h,onHide:k,children:[Object(I.jsx)(q.a.Header,{closeButton:!0,children:Object(I.jsx)(q.a.Title,{children:"Edit Task"})}),Object(I.jsx)(q.a.Body,{children:Object(I.jsxs)(y.a,{children:[Object(I.jsxs)(y.a.Group,{controlId:"title",children:[Object(I.jsx)(y.a.Label,{children:"Title"}),Object(I.jsx)(y.a.Control,{type:"text",value:x,onChange:function(e){return v(e.target.value)}})]}),Object(I.jsxs)(y.a.Group,{controlId:"description",children:[Object(I.jsx)(y.a.Label,{children:"Description"}),Object(I.jsx)(y.a.Control,{type:"text",value:w,onChange:function(e){return N(e.target.value)}})]})]})}),Object(I.jsxs)(q.a.Footer,{children:[Object(I.jsx)(S.a,{variant:"secondary",onClick:k,children:"Close"}),Object(I.jsx)(S.a,{variant:"primary",onClick:function(){return function(e,a){k(),""!==e&&""!==a&&(i({id:t,title:e,body:a}),v(e),N(a))}(x,w)},children:"Save Changes"})]})]})]})})};function P(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{headers:{Authorization:"Bearer "+e.accessToken}}:{}}var U=a(265),G=a(127),z=a.n(G),D="http://api.test/api",M=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),a=t[0],s=t[1],n=Object(r.useState)([]),c=Object(l.a)(n,2),i=c[0],o=c[1],b=Object(r.useState)(!1),m=Object(l.a)(b,2),O=m[0],v=m[1],f=Object(r.useState)(!1),g=Object(l.a)(f,2),w=g[0],N=g[1],y=Object(r.useState)(!1),S=Object(l.a)(y,2),C=S[0],T=S[1];z()(x.a,k.refreshAuthLogic),Object(r.useEffect)((function(){k.getCurrentUser()&&B()}),[]);var B=function(){var e=Object(h.a)(p.a.mark((function e(){var t,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.get(D+"/tasks",P());case 3:t=e.sent,a=t.data,s(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.post(D+"/tasks",t,P());case 3:B(),M(),v(!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(h.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=a.find((function(e){return e.id===t}))).completed=!r.completed,e.prev=2,e.next=5,x.a.patch(D+"/tasks/".concat(t),r,P());case 5:B(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.patch(D+"/tasks/".concat(t.id),t,P());case 3:M(),T(!0),B(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),G=function(){var e=Object(h.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x.a.delete(D+"/tasks/".concat(t),P());case 3:M(),N(!0),B(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),M=function(){v(!1),N(!1),T(!1)};return Object(I.jsx)("div",{className:"wrapper",children:k.getCurrentUser&&Object(I.jsx)(u.a,{children:Object(I.jsxs)(d.a,{className:"justify-content-center",children:[Object(I.jsxs)("div",{className:"mt-3",children:[Object(I.jsx)(U.a,{onClose:function(){return v(!1)},dismissible:!0,show:O,variant:"success",children:"Task was added"}),Object(I.jsx)(U.a,{onClose:function(){return N(!1)},dismissible:!0,show:w,variant:"danger",children:"Task was deleted"}),Object(I.jsx)(U.a,{onClose:function(){return T(!1)},dismissible:!0,show:C,variant:"warning",children:"Task was edited"})]}),Object(I.jsxs)(j.a,{children:[Object(I.jsx)(L,{addTask:E,errors:i,setErrors:o}),a.map((function(e,t){return Object(I.jsx)(J,{errors:i,setErrors:o,id:e.id,title:e.title,completed:e.completed,description:e.body,changeTaskState:A,editTask:q,deleteTask:G},t)}))]})]})})})};a(256);var V=function(){var e=Object(r.useState)(void 0),t=Object(l.a)(e,2),a=t[0],s=t[1],n=Object(r.useState)(!1),c=Object(l.a)(n,2),h=c[0],m=c[1];Object(r.useEffect)((function(){var e=k.getCurrentUser();e&&(s(e),m(!0))}),[]);var p=function(e){var t=e.auth.isAuthenticated,a=e.children;return t?a:Object(I.jsx)(o.a,{to:"/login"})},O=function(e){var t=e.auth.isAuthenticated,a=e.children;return t?a:Object(I.jsx)(o.a,{to:"/home"})};return Object(I.jsxs)("div",{children:[Object(I.jsx)("nav",{className:"navbar navbar-expand navbar-dark bg-dark",children:Object(I.jsxs)("div",{className:"container",children:[Object(I.jsx)("div",{className:"navbar-nav mr-auto",children:Object(I.jsx)("li",{className:"nav-item",children:Object(I.jsx)(i.b,{to:"/",className:"nav-link",children:"myTasks"})})}),a?Object(I.jsx)("div",{className:"navbar-nav ms-auto",children:Object(I.jsx)("li",{className:"nav-item",children:Object(I.jsx)(i.b,{to:"/login",className:"nav-link",onClick:function(){k.logout(),window.location.reload()},children:"Logout"})})}):Object(I.jsxs)("div",{className:"navbar-nav ms-auto",children:[Object(I.jsx)("li",{className:"nav-item",children:Object(I.jsx)(i.b,{to:"/login",className:"nav-link",children:"Login"})}),Object(I.jsx)("li",{className:"nav-item",children:Object(I.jsx)(i.b,{to:"/signup",className:"nav-link",children:"Sign up"})})]})]})}),Object(I.jsx)("div",{className:"container",children:Object(I.jsx)(u.a,{children:Object(I.jsx)(d.a,{className:"justify-content-center pt-5",children:Object(I.jsx)(j.a,{md:"8",children:Object(I.jsx)(b.a,{children:Object(I.jsxs)(o.d,{children:[Object(I.jsx)(o.b,{path:"/",element:Object(I.jsxs)(p,{auth:{isAuthenticated:h},children:[" ",Object(I.jsx)(M,{})," "]})}),Object(I.jsx)(o.b,{path:"/home",element:Object(I.jsxs)(p,{auth:{isAuthenticated:h},children:[" ",Object(I.jsx)(M,{})," "]})}),Object(I.jsx)(o.b,{path:"/signup",element:Object(I.jsxs)(O,{auth:{isAuthenticated:!h},children:[" ",Object(I.jsx)(E,{setIsAUth:m})," "]})}),Object(I.jsx)(o.b,{path:"/login",element:Object(I.jsxs)(O,{auth:{isAuthenticated:!h},children:[" ",Object(I.jsx)(B,{setIsAUth:m})," "]})})]})})})})})})]})};c.a.render(Object(I.jsx)(s.a.StrictMode,{children:Object(I.jsx)(i.a,{children:Object(I.jsx)(V,{})})}),document.getElementById("root"))}},[[257,1,2]]]);
//# sourceMappingURL=main.3cccd826.chunk.js.map